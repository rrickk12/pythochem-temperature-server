## ğŸ“ Project Structure: BLE Data Server

### Root Directory Layout
```bash
ble-data-server/
â”‚
â”œâ”€â”€ listener/           # Handles incoming data from BLE gateway
â”‚   â””â”€â”€ listener.py
â”‚
â”œâ”€â”€ db_ops/             # Handles all DB-related operations
â”‚   â”œâ”€â”€ models.py
â”‚   â””â”€â”€ db_handler.py
â”‚
â”œâ”€â”€ scheduler/          # Handles scheduling, triggers, timed workflows
â”‚   â””â”€â”€ scheduler.py
â”‚
â”œâ”€â”€ report/             # API endpoints, report structures,datainterface
â”‚   â””â”€â”€ report_api.py
â”‚
â”œâ”€â”€ config/             # Configuration, secrets, templates
â”‚   â””â”€â”€ settings.yaml
â”‚
â”œâ”€â”€ utils/              # Shared helper functions
â”‚   â””â”€â”€ parser.py
â”‚
â”œâ”€â”€ tests/              # Unit tests per module
â”‚
â”œâ”€â”€ main.py             # Entry point
â””â”€â”€ requirements.txt    # Dependencies
```

---

## ğŸ§© Module Specifications

---

### `listener/listener.py`

- **@description**  
    Listens for incoming POST requests from BLE gateways, parses the payload, and dispatches structured data to the internal workflow.
    
- **@parameters**
    
    - `POST /data` with sensor payload
        
    - JSON body with gateway data
        
- **@output**
    
    - Structured sensor data
        
    - Emits event or calls handler to store/process data
        

---

### `db_ops/db_handler.py`

- **@description**  
    Abstracts all database operations (insert, query, update, delete). Central authority for data persistence.
    
- **@parameters**
    
    - `operation: str` â€“ e.g. `"insert"`, `"query_by_mac"`, etc
        
    - `payload: dict` â€“ content of operation
        
- **@output**
    
    - Success status
        
    - Query results, if applicable
        

---

### `db_ops/models.py`

- **@description**  
    Defines database schema, table definitions, and data modeling (e.g. SQLAlchemy or Pydantic schemas).
    
- **@parameters**
    
    - None (used by `db_handler`)
        
- **@output**
    
    - Database models / ORM bindings
        

---

### `scheduler/scheduler.py`

- **@description**  
    Manages scheduled events (e.g. timed backups, report generation). Can load/save schedule templates.
    
- **@parameters**
    
    - `schedule: dict` â€“ timing, actions, targets
        
    - `event_hook: function` â€“ to trigger workflows
        
- **@output**
    
    - Timed execution or state update
        
    - Callback triggering
        

---

### `report/report_api.py`

- **@description**  
    API module that exposes endpoints for the visualizer/frontend, allowing report generation, querying sensor history, and configuring behaviours.
    
- **@parameters**
    
    - HTTP `GET/POST` endpoints
        
    - Query strings / JSON configs
        
- **@output**
    
    - JSON responses with data
        
    - PDF/CSV reports (optional)
        

---

### `utils/parser.py`

- **@description**  
    Contains reusable functions to parse and normalize BLE payloads, format timestamps, convert units, etc.
    
- **@parameters**
    
    - `raw_payload: bytes | str`
        
- **@output**
    
    - Parsed, validated sensor data dict
        

---

## ğŸ›  Suggested First Dev Sprint

|Task|Module|Description|
|---|---|---|
|1. Create BLE POST listener|`listener/`|Accept incoming data, basic logging|
|2. Define DB schema|`db_ops/models.py`|Sensor data model (timestamp, MAC, temp, etc)|
|3. Create DB handler functions|`db_ops/db_handler.py`|Insert + basic select|
|4. Parse payload|`utils/parser.py`|Basic BLE data decoding|
|5. Connect listener â†’ parser â†’ DB|`main.py`|Basic data pipeline|
|6. Setup config file|`config/settings.yaml`|Store port, DB path, etc|




# Project Modules: Usage and API Documentation

## Overview

This project manages sensor data using a SQLAlchemy-based database. The code is organized into several parts:

- **db_ops:** Contains database connection and ORM model definitions.
- **blueprints:** Hosts Flask blueprints for endpoint definitions (listener, report, and view).
- **modules:** Provides helper modules including a service layer, data reader, and report generator.
- **scheduler:** Runs periodic tasks such as data compression and alert checking.

## Project Structure

project/ â”œâ”€â”€ db_ops/ â”‚ â”œâ”€â”€ db_manager.py â”‚ â””â”€â”€ models.py â”œâ”€â”€ blueprints/ â”‚ â”œâ”€â”€ listener.py â”‚ â”œâ”€â”€ report.py â”‚ â””â”€â”€ view.py â”œâ”€â”€ modules/ â”‚ â”œâ”€â”€ reader.py â”‚ â”œâ”€â”€ report.py â”‚ â””â”€â”€ service.py â”œâ”€â”€ scheduler/ â”‚ â””â”€â”€ scheduler.py â””â”€â”€ USAGE.md

python
Copy

## Getting Started

1. **Dependencies:**  
   - Python 3  
   - Flask  
   - SQLAlchemy  
   - (Other dependencies such as a payload parser in `utils`)

2. **Running the Web App:**  
   Integrate the blueprints (listener, report, view) into your Flask application:
   ```python
   from flask import Flask
   from blueprints.listener import listener_bp
   from blueprints.report import report_bp
   from blueprints.view import view_bp

   app = Flask(__name__)
   app.register_blueprint(listener_bp)
   app.register_blueprint(report_bp)
   app.register_blueprint(view_bp)

   if __name__ == '__main__':
       app.run(debug=True)




       # Project Modules: Usage and API Documentation

## Overview

This project manages sensor data using a SQLAlchemy-based database. The code is organized into several parts:

- **db_ops:** Contains database connection and ORM model definitions.
- **blueprints:** Hosts Flask blueprints for endpoint definitions (listener, report, and view).
- **modules:** Provides helper modules including a service layer, data reader, and report generator.
- **scheduler:** Runs periodic tasks such as data compression and alert checking.

## Project Structure

project/ â”œâ”€â”€ db_ops/ â”‚ â”œâ”€â”€ db_manager.py â”‚ â””â”€â”€ models.py â”œâ”€â”€ blueprints/ â”‚ â”œâ”€â”€ listener.py â”‚ â”œâ”€â”€ report.py â”‚ â””â”€â”€ view.py â”œâ”€â”€ modules/ â”‚ â”œâ”€â”€ reader.py â”‚ â”œâ”€â”€ report.py â”‚ â””â”€â”€ service.py â”œâ”€â”€ scheduler/ â”‚ â””â”€â”€ scheduler.py â””â”€â”€ USAGE.md

python
Copy

## Getting Started

1. **Dependencies:**  
   - Python 3  
   - Flask  
   - SQLAlchemy  
   - (Other dependencies such as a payload parser in `utils`)

2. **Running the Web App:**  
   Integrate the blueprints (listener, report, view) into your Flask application:
   ```python
   from flask import Flask
   from blueprints.listener import listener_bp
   from blueprints.report import report_bp
   from blueprints.view import view_bp

   app = Flask(__name__)
   app.register_blueprint(listener_bp)
   app.register_blueprint(report_bp)
   app.register_blueprint(view_bp)

   if __name__ == '__main__':
       app.run(debug=True)